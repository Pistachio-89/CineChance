---
phase: 03-lint-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true
requirements: []
gap_closure: true
must_haves:
  truths:
    - "npm run lint проходит без ошибок (0 errors)"
    - "Код использует типизированные типы вместо any"
    - "Нет неиспользуемых переменных"
    - "Нет проблем с react-hooks"
  artifacts: []
  key_links: []
---

<objective>
Исправить оставшиеся 439 ошибок lint для достижения цели "npm run lint = 0 errors".

Gap closure: адресует 4 failed must-haves из VERIFICATION.md.
</objective>

<context>
# Gaps from VERIFICATION.md

## Gap 1: @typescript-eslint/no-explicit-any (209 errors)
- src/app/api/debug/real-status-ids/route.ts
- src/app/api/debug/stats/route.ts
- src/lib/tmdb.ts
- И многие другие файлы

## Gap 2: no-unused-vars (356 errors)
- src/app/admin/invitations/InvitationsAdminClient.tsx
- src/app/admin/monitoring/page.tsx
- src/app/api/blacklist/all/route.ts
- src/app/api/my-movies/route.ts

## Gap 3: react-hooks (28 issues)
- set-state-in-effect, exhaustive-deps, rules-of-hooks

## Current state
- 439 errors, 168 warnings
- console.log → logger: DONE
</context>

<tasks>

<task type="auto">
  <name>Task 1: Типизировать any типы</name>
  <files>[]</files>
  <action>
Для каждого файла с @typescript-eslint/no-explicit-any:
1. Определить правильный тип на основе контекста
2. Использовать `unknown` где тип неизвестен
3. Создать интерфейсы для TMDB API ответов в отдельном файле типов

Фокус на самых частых случаях:
- function parameters
- catch blocks
- API response handling
  </action>
  <verify>`npm run lint 2>&1 | grep -c "@typescript-eslint/no-explicit-any"`</verify>
  <done>0 или минимум ошибок any типов</done>
</task>

<task type="auto">
  <name>Task 2: Исправить неиспользуемые переменные</name>
  <files>[]</files>
  <action>
Для каждого файла с no-unused-vars:
1. Если параметр не используется — добавить префикс _ (например, _userId)
2. Если переменная не нужна — удалить строку
3. Для catch (error) — использовать error instanceof Error

Прогнать npx eslint --fix для auto-fixable случаев.
Оставшиеся исправить вручную.
  </action>
  <verify>`npm run lint 2>&1 | grep -c "no-unused-vars"`</verify>
  <done>0 или минимум ошибок unused-vars</done>
</task>

<task type="auto">
  <name>Task 3: Исправить react-hooks проблемы</name>
  <files>[]</files>
  <action>
Для каждого файла с react-hooks/* ошибками:
1. Исправить exhaustive-deps: добавить/удалить зависимости в массив
2. Избегать setState в useEffect: использовать useMemo, условную логику или хелперы
3. Исправить rules-of-hooks: проверить порядок вызовов хуков
  </action>
  <verify>`npm run lint 2>&1 | grep -c "react-hooks"`</verify>
  <done>0 ошибок react-hooks</done>
</task>

<task type="auto">
  <name>Task 4: Финальная проверка</name>
  <files>[]</files>
  <action>
Запустить `npm run lint` и убедиться что:
- 0 errors
- Предупреждения допустимы
  </action>
  <verify>`npm run lint`</verify>
  <done>npm run lint проходит чисто (0 errors)</done>
</task>

</tasks>

<verification>
`npm run lint` возвращает 0 errors
</verification>

<success_criteria>
- Все 439 оставшихся errors исправлены
- Достигнута цель: npm run lint = 0 errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-lint-cleanup/{phase}-02-SUMMARY.md`
</output>
